{% extends "layouts/client_base.html" %}
{% block page_title %}Files{% endblock %}

{% block content %}
<div class="files-wrapper files-wrapper">

  <div class="files-header files-topbar table-filter-bar">
    <input type="text" class="files-search" id="meetingSearch" placeholder="Search">
  </div>

  <div class="files-page">
    <table class="files-table">
      <thead>
  <tr>
    <th>
      <span class="th-flex">
        <strong>#</strong>
        <i class="bi bi-arrow-up"></i>
        <i class="bi bi-three-dots-vertical"></i>
      </span>
    </th>

    <th>
      <span class="th-flex">
        <strong>Desc</strong>
        <i class="bi bi-arrow-up"></i>
        <i class="bi bi-three-dots-vertical"></i>
      </span>
    </th>

    <th>
      <span class="th-flex">
        <strong>FileName</strong>
        <i class="bi bi-arrow-up"></i>
        <i class="bi bi-three-dots-vertical"></i>
      </span>
    </th>

    <th>
      <span class="th-flex">
        <strong>Public</strong>
        <i class="bi bi-arrow-up"></i>
        <i class="bi bi-three-dots-vertical"></i>
      </span>
    </th>

    <th>
      <span class="th-flex">
        <strong>Uploaded by</strong>
        <i class="bi bi-arrow-up"></i>
        <i class="bi bi-three-dots-vertical"></i>
      </span>
    </th>

    <th class="text-center">
      <strong>Download</strong>
    </th>
  </tr>
      </thead>

      <tbody id="filename">
        {% if files %}
          {% for f in files %}
          <tr>
            <td>{{ loop.index }}</td>

            <td>{{ f.description or 'No description' }}</td>

            <td class="file-name">
              {{ f.filename }}
            </td>

            <td class="text-center">
              <i class="bi bi-check-square-fill public-icon"></i>
            </td>

            <td>{{ f.uploaded_by_name or 'Unknown' }}</td>

            <td class="actions">
              <a href="{{ url_for('download_file', filename=f.filename) }}"
                 class="download-btn"
                 title="Download"
                 download>
                <i class="bi bi-download"></i> 
              </a>
            </td>
          </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="6" class="text-center empty-row text-muted">No files available. Contact admin to grant access to files.</td>
          </tr>
        {% endif %}
      </tbody>
    </table>

    <div class="pagination-bar">
      Rows per page:
      <select disabled>
        <option>50</option>
      </select>
      <span>1-{{ files|length }} of {{ files|length }}</span>
      <span class="pagination-arrows">◀ ▶</span>
    </div>

  </div>

</div>

<script>
  document.getElementById("meetingSearch").addEventListener("input", function () {
    const term = this.value.toLowerCase();
    document.querySelectorAll("#filename tr").forEach(row => {
      const text = row.innerText.toLowerCase();
      row.style.display = text.includes(term) ? "" : "none";
    });
  });

</script>

{% endblock %}

