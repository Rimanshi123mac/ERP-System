{% extends "layouts/admin_base.html" %}

{% block page_title %}Core Data{% endblock %}

{% block content %}

<link rel="stylesheet" href="{{ url_for('static', filename='admin-3-clientApps.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='bootstrap-icons/bootstrap-icons.css') }}">

<div class="admin-section-container">

  <div class="section-header">
    <h3 class="title">Core Data</h3>

    <button id="openPopupBtn" class="fab-btn">+</button>
  </div>

  <div class="software-grid">
    {% if files %}
      {% for f in files %}
      <div class="software-card">
        <div class="software-logo">
          <img src="{{ url_for('static', filename='images/N_logo.png') }}" alt="Logo">
        </div>
        <div class="software-info">
          <h4>{{ f.title }}</h4>
          <p>{{ f.description }}</p>
        </div>

        <div class="software-actions">
          <a href="{{ url_for('download_core_file', file_id=f.id) }}" 
             class="open-btn">
             <i class="bi bi-download"></i> Download
          </a>

          <a href="{{ url_for('admin_delete_core_data', file_id=f.id) }}"
             class="delete-btn"
             onclick="return confirm('Delete this file?');">
             <i class="bi bi-trash"></i> Delete
          </a>
        </div>

      </div>
      {% endfor %}
    {% else %}
      <div class="alert alert-info text-center" style="grid-column: 1 / -1; padding: 40px;">
        <h5>No Software Available</h5>
        <p class="mb-0">No software has been uploaded yet. Click the + button to upload software.</p>
      </div>
    {% endif %}
  </div> 

  

</div>
<!-- <button id="openPopupBtn" class="fab-btn">+</button>  -->
<div id="coreOverlay" class="overlay hidden"></div>

<div id="popup" class="popup hidden">

  <div class="popup-header">
    <h3>Add Software</h3>
    <span id="closePopupBtn" class="close-btn">Ã—</span>
  </div>

  <form method="POST" 
        action="{{ url_for('admin_upload_core_data') }}"
        enctype="multipart/form-data">
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">

    <label>Title</label>
    <input type="text" name="title" required>

    <label>Description</label>
    <textarea name="description"></textarea>

    <label>File (.exe or .tar only)</label>
    <input type="file" name="file" accept=".exe,.tar" required>

    <div class="btn-group">
      <button type="button" id="cancelPopupBtn" class="cancel-btn">Cancel</button>
      <button type="submit" class="upload-btn">Upload</button>
    </div>

  </form>
</div>


<script src="{{ url_for('static', filename='script/admin-4-coreData.js') }}"></script>

{% endblock %}
